# /home/randao/RandomnProvider/docker-compose/postgres/postgresql.conf
# --- Memory ---
# Total available RAM is 512MB (0.5GB)
# Target for Postgres container is 150MB limit
shared_buffers = 40MB              # ~25% of Postgres container's 150MB limit
work_mem = 1MB                     # For sorting/hashing per operation (start low)
maintenance_work_mem = 16MB        # For VACUUM, CREATE INDEX (lower than default)
effective_cache_size = 60MB        # Estimate of OS + shared_buffers cache (roughly 40% of container limit)
wal_buffers = 2MB                  # Smaller WAL buffers for low write loads

# --- Connections ---
max_connections = 20               # Limit connections to reduce per-connection memory overhead
                                   # Adjust based on orchestrator's needs.

# --- Checkpointing ---
# Aim to reduce write spikes for low I/O systems
checkpoint_timeout = 10min         # Increase from default 5min
max_wal_size = 256MB               # Equivalent to ~16 checkpoint segments (16MB each)
checkpoint_completion_target = 0.9 # Spread out checkpoint writes more

# --- Autovacuum ---
# Autovacuum can be resource-intensive; aggressive settings
# might be needed to keep table bloat down, but tune carefully.
# autovacuum_max_workers = 1       # Reduce workers
# autovacuum_vacuum_scale_factor = 0.05 # Vacuum more frequently on small tables
# autovacuum_analyze_scale_factor = 0.02 # Analyze more frequently
